function [ProfileFilt]= ProfileFilt(Seg,Profile)
%Name: Hossein Rejali
%Supervisor: Dr. Ali Khan
%Date: May 16th,2018
%Title: Profile Filtering
%% ............................Description................................
% ProfileFilt(ImgSeg,Profile)
% Profiles may end beyon the domain of the laplace solution (beyond GM
% region), therefore we use the segmented image (ImgSeg) to mask out
% regions in which the profile is out of range

% 1) <Seg>: Segmented image assuming labels are as follows: GM==1, WM==2
% Background==3 and Ignore==4
% 2) <Profile>: Single Profile or Streamline obtained from the segmented image 
% 3) <ProfileFilt>: Filtered out Streamline by masking out points outside
% of GM region
%% ...........................Initialize Variables........................
Profile=cell2mat(Profile); % convert to matrix 
len=size(Profile);
%% ...............................Mask values.............................
% Check if x y coordinates of the streamline fall outside of GM region
for(i=1:len(1))
    vec=Profile(i,:); 
    x=vec(1);y=vec(2);
    if(Seg(round(y),round(x))~=1)
        ProfileFilt(i,:)=nan;
    else
        ProfileFilt(i,:)=Profile(i,:);
    end
end
%Get rid of the NaN values entierly
ProfileFilt(isnan(ProfileFilt))=[];


end